/* ==========================================================================
   Dark Mode
   ========================================================================== */

/* Dark mode variables */
:root {
  --bg-color: #{$background-color};
  --body-color: #{$body-color};
  --text-color: #{$text-color};
  --border-color: #{$border-color};
  --code-bg-color: #{$code-background-color};
  --link-color: #{$link-color};
  --link-hover-color: #{$link-color-hover};
  --masthead-link-color: #{$masthead-link-color};
  --primary-color: #{$primary-color};
  --light-gray: #{$light-gray};
  --lighter-gray: #{$lighter-gray};
}

/* Dark theme colors */
[data-theme="dark"] {
  --bg-color: #1a1a1a;
  --body-color: #2d2d2d;
  --text-color: #e0e0e0;
  --border-color: #404040;
  --code-bg-color: #2a2a2a;
  --link-color: #e0e0e0; /* Light gray for dark mode */
  --link-hover-color: #8A6BB1; /* Same purple hover */
  --masthead-link-color: #e0e0e0; /* Light gray for masthead in dark mode */
  --primary-color: #b0b0b0;
  --light-gray: #505050;
  --lighter-gray: #404040;
}

/* Apply CSS variables */
html {
  background-color: var(--bg-color);
  transition: background-color 0.3s ease, color 0.3s ease;
}

body {
  background-color: var(--body-color);
  color: var(--text-color);
  transition: background-color 0.3s ease, color 0.3s ease;
}

/* Text colors */
h1, h2, h3, h4, h5, h6 {
  color: var(--text-color);
}

p, li, td, th {
  color: var(--text-color);
}

/* Links */
a {
  color: var(--text-color); /* Default text color matching content */
  text-decoration: none;
  transition: all 0.2s ease;
  
  &:hover {
    color: #8A6BB1; /* Purple on hover */
  }
}

/* Masthead */
.masthead {
  background-color: var(--body-color);
  border-bottom: 1px solid var(--border-color);
  
  a {
    color: var(--masthead-link-color);
    
    &:hover {
      color: #8A6BB1;
    }
  }
}

/* Code blocks */
code {
  background-color: var(--code-bg-color);
  color: var(--text-color);
}

pre {
  background-color: var(--code-bg-color);
  border: 1px solid var(--border-color);
}

/* Borders */
.page__content,
.sidebar,
.archive__item {
  border-color: var(--border-color);
}

/* Navigation */
.greedy-nav {
  background: var(--body-color);
  
  a {
    color: #e0e0e0; /* Light gray for dark mode */
    
    &:hover {
      color: #8A6BB1;
    }
  }
  
  .navicon {
    background: var(--text-color);
    
    &:before,
    &:after {
      background: var(--text-color);
    }
  }
  
  .hidden-links {
    background: var(--background-color); /* Use background color for consistency */
    border-color: var(--border-color);
    
    a {
      color: var(--link-color); /* Use the same link color */
      
      &:hover {
        color: var(--link-hover-color); /* Same purple hover */
        background: var(--lighter-gray); /* Subtle hover background */
      }
    }
  }
}

/* Footer */
.page__footer {
  background-color: var(--body-color);
  color: var(--text-color);
  border-top: 1px solid var(--border-color);
  
  footer {
    color: var(--text-color);
  }
}

/* Sidebar */
.sidebar {
  background-color: var(--body-color);
  
  .author__avatar img {
    border: 2px solid var(--border-color);
  }
  
  .author__bio {
    color: var(--text-color);
  }
}

/* Archive items */
.archive__item {
  background-color: var(--body-color);
  
  .archive__item-title {
    color: var(--text-color);
    
    a {
      color: var(--text-color);
      
      &:hover {
        color: #8A6BB1;
      }
    }
  }
  
  .archive__item-excerpt {
    color: var(--text-color);
  }
}

/* Forms */
input,
textarea,
select {
  background-color: var(--body-color);
  border-color: var(--border-color);
  color: var(--text-color);
}

/* Tables */
table {
  background-color: var(--body-color);
  border-color: var(--border-color);
  
  th,
  td {
    border-color: var(--border-color);
    color: var(--text-color);
  }
  
  thead th {
    background-color: var(--light-gray);
  }
}

/* Dark mode toggle button */
.dark-mode-toggle {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background-color: var(--body-color);
  border: 2px solid var(--border-color);
  border-radius: 50%;
  width: 50px;
  height: 50px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s ease;
  z-index: 1000;
  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
  
  &:hover {
    transform: scale(1.1);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
  }
  
  .toggle-icon {
    font-size: 1.2em;
    color: var(--text-color);
    transition: transform 0.3s ease;
  }
  
  &:hover .toggle-icon {
    transform: rotate(15deg);
  }
}

/* Academic Cards Dark Mode Overrides */
[data-theme="dark"] {
  /* Publication and filter elements */
  .publication-item__journal {
    color: #b0b0b0 !important;
  }
  
  .publication-item__authors {
    color: #d0d0d0 !important;
  }
  
  .publication-item__title a {
    color: #e0e0e0 !important; /* Light gray text in dark mode */
    
    &:hover {
      color: #8A6BB1 !important; /* Purple on hover */
    }
  }
  
  .tag {
    background: #404040 !important;
    color: #e0e0e0 !important;
    border: 1px solid #505050 !important;
    
    &:hover {
      background: #505050 !important;
      color: #ffffff !important;
    }
  }
  
  .filter-tabs {
    background: #2a2a2a !important;
    border-color: #404040 !important;
  }
  
  .keywords-filter {
    background: #2a2a2a !important;
  }
  
  .filter-label {
    color: #b0b0b0 !important;
  }
  
  .filter-tab {
    background: #2d2d2d !important;
    border-color: #404040 !important;
    color: #e0e0e0 !important;
    
    &:hover {
      border-color: #64b5f6 !important;
    }
    
    &.active {
      background: #64b5f6 !important;
      border-color: #64b5f6 !important;
      color: #ffffff !important;
    }
  }
  
  /* Research cards */
  .research-card {
    background: #2d2d2d !important;
    border-color: #404040 !important;
    
    &:hover {
      border-color: #64b5f6 !important;
    }
  }
  
  .research-card__title {
    color: #64b5f6 !important;
  }
  
  .research-card__content {
    color: #e0e0e0 !important;
  }
  
  .research-card__section-title {
    color: #64b5f6 !important;
  }
  
  /* People cards */
  .person-card {
    background: #2d2d2d !important;
    border-color: #404040 !important;
  }
  
  .person-card__name {
    color: #64b5f6 !important;
  }
  
  .person-card__position {
    background: #64b5f6 !important;
    color: #ffffff !important;
  }
  
  .person-card__description {
    color: #e0e0e0 !important;
  }
  
  /* Community cards */
  .community-card {
    background: #2d2d2d !important;
    border-color: #404040 !important;
    
    &:hover {
      border-color: #64b5f6 !important;
    }
  }
  
  .community-card__title {
    color: #64b5f6 !important;
  }
  
  .community-card__content {
    color: #e0e0e0 !important;
  }
  
  .community-card__meta {
    color: #b0b0b0 !important;
  }
  
  .community-card__expand-indicator {
    color: #64b5f6 !important;
  }
  
  /* Teaching cards */
  .teaching-card {
    background: #2d2d2d !important;
    border-color: #404040 !important;
    
    &:hover {
      border-color: #64b5f6 !important;
    }
  }
  
  .teaching-card__title {
    color: #64b5f6 !important;
  }
  
  .teaching-card__type {
    background: #64b5f6 !important;
    color: #ffffff !important;
  }
  
  .teaching-card__venue {
    color: #b0b0b0 !important;
  }
  
  .teaching-card__content {
    color: #e0e0e0 !important;
  }
  
  /* Photography cards */
  .photography-card {
    background: #2d2d2d !important;
    border-color: #404040 !important;
  }
  
  .photography-card__title {
    color: #64b5f6 !important;
  }
  
  .photography-card__description {
    color: #e0e0e0 !important;
  }
  
  /* Page headers */
  .page-header__title {
    color: #64b5f6 !important;
  }
  
  .page-header__subtitle {
    color: #d0d0d0 !important;
  }
  
  /* Hiring alert */
  .hiring-alert {
    background: #2a2a2a !important;
    border-left: 4px solid #64b5f6 !important;
    border-radius: 8px !important;
    color: #e0e0e0 !important;
    
    strong {
      color: #64b5f6 !important;
    }
    
    p {
      color: #e0e0e0 !important;
    }
  }
  
  /* Author profile and news */
  .author-news-section {
    background: #2a2a2a !important;
    border-left: 3px solid #64b5f6 !important;
    color: #e0e0e0 !important;
  }
  
  .author-news__title {
    color: #64b5f6 !important;
  }
  
  .author-news__date {
    color: #64b5f6 !important;
  }
  
  .author-news__content {
    color: #e0e0e0 !important;
  }
  
  .author-news__item {
    border-bottom: 1px solid #404040 !important;
  }
  
  .author-news__list {
    /* Override any scrollbar styling if needed */
    &::-webkit-scrollbar {
      width: 6px;
    }
    
    &::-webkit-scrollbar-track {
      background: #404040;
    }
    
    &::-webkit-scrollbar-thumb {
      background: #64b5f6;
      border-radius: 3px;
    }
  }
  
  /* Publications section titles */
  .publications-section__title {
    color: #64b5f6 !important;
  }
  
  /* Generic text colors for any missed elements */
  .card-content,
  .section-content,
  .description-text {
    color: #e0e0e0 !important;
  }
  
  /* Ensure all hard-coded grays are readable */
  .text-gray-600,
  .text-gray-700,
  .text-gray-800 {
    color: #b0b0b0 !important;
  }
  
  /* Links within cards */
  .research-papers-list a,
  .publication-link,
  .community-link,
  .person-link {
    color: #64b5f6 !important;
    
    &:hover {
      color: #42a5f5 !important;
    }
  }
}

/* Responsive adjustments for mobile */
@media (max-width: 768px) {
  .dark-mode-toggle {
    width: 45px;
    height: 45px;
    
    .toggle-icon {
      font-size: 1em;
    }
  }
}